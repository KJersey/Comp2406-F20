const config = require('./config.js');
const request = require('request');
const ip = config.ip;
const port = config.port;

let num_failed = 0;

function testAPI(uri, expected) {
    request(ip + port + '/' + uri, null, (err, res, body) =>
    {
        // console.log("Testing /" + uri);
        let response = body;
        // console.log(response);
        if (expected) {
            if (response === expected) {
                // console.log("Expected Result!");
            }
            else {
                console.log("Testing /" + uri);
                console.log(response);
                console.log("Unexpected Result! Result should be:");
                console.log(expected);
                num_failed++;
            }
        }
        // console.log();
        return response;
    });
}

// test GET /user/:username
testAPI('users/Dave', '{"Username":"Dave","Password":"frodo","Contributor":false,"FollowedPeople":[],"FollowedUsers":["Malcolm"],"Reviews":["28","29"]}');

// test GET /allUsers
testAPI('allUsers', '[{"Username":"Malcolm","Password":"password1","Contributor":true,"FollowedPeople":[],"FollowedUsers":["Jersey","Dave"],"Reviews":["3","23"]},{"Username":"Dave","Password":"frodo","Contributor":false,"FollowedPeople":[],"FollowedUsers":["Malcolm"],"Reviews":["28","29"]},{"Username":"Jersey","Password":"shore","Contributor":true,"FollowedPeople":["Mike Myers","Eddie Murphy","Will Smith"],"FollowedUsers":["Dave","Malcolm"],"Reviews":["1","21","22","25","26","27"]}]');

// test GET /searchUser
testAPI('searchUser/Dave', '[{"Username":"Dave","Password":"frodo","Contributor":false,"FollowedPeople":[],"FollowedUsers":["Malcolm"],"Reviews":["28","29"]}]');

// test GET /isContributor/:username
testAPI('isContributor/Dave', 'false');
testAPI('isContributor/Malcolm', 'true');

// test GET /getMovie/:movieID
testAPI('getMovie/tt0077869', '{"Title":"The Lord of the Rings","Year":"1978","Rated":"PG","Released":"15 Nov 1978","Runtime":"132 min","Genre":"Animation, Adventure, Fantasy","Director":"Ralph Bakshi","Writer":"Chris Conkling (screenplay), Peter S. Beagle (screenplay), J.R.R. Tolkien (novels)","Actors":"Christopher Guard, William Squire, Michael Scholes, John Hurt","Plot":"The Fellowship of the Ring embark on a journey to destroy the One Ring and end Sauron\'s reign over Middle-earth.","Language":"English, Sindarin","Country":"USA, UK, Spain","Awards":"Nominated for 1 Golden Globe. Another 1 win & 2 nominations.","Poster":"https://m.media-amazon.com/images/M/MV5BOGMyNWJhZmYtNGQxYi00Y2ZjLWJmNjktNTgzZWJjOTg4YjM3L2ltYWdlXkEyXkFqcGdeQXVyNTAyODkwOQ@@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"6.2/10"},{"Source":"Rotten Tomatoes","Value":"52%"}],"Metascore":"N/A","imdbRating":"6.2","imdbVotes":"28,852","imdbID":"tt0077869","Type":"movie","DVD":"11 Sep 2001","BoxOffice":"N/A","Production":"WARNER BROTHERS PICTURES","Website":"N/A","Response":"True"}');

// test GET /searchMovie/:query
testAPI('searchMovie/the%20room', '[{"Title":"Enron: The Smartest Guys in the Room","Year":"2005","Rated":"R","Released":"13 Oct 2005","Season":"8","Episode":"22","Runtime":"109 min","Genre":"Documentary","Director":"Alex Gibney","Writer":"Bethany McLean (book), Peter Elkind (book), Alex Gibney","Actors":"Peter Coyote, John Beard, Barbara Boxer, George W. Bush","Plot":"Corporate audio and videotapes tell the inside story of the scandal involving one company\'s manipulation of California\'s energy supply and its, and how its executives wrung a billion dollars out of the resulting crisis.","Language":"English","Country":"USA","Awards":"N/A","Poster":"https://m.media-amazon.com/images/M/MV5BODM5NzgyNTMyN15BMl5BanBnXkFtZTcwMDU0NzgyMQ@@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"7.8/10"},{"Source":"Rotten Tomatoes","Value":"97%"},{"Source":"Metacritic","Value":"82/100"}],"Metascore":"82","imdbRating":"7.8","imdbVotes":"4512","imdbID":"tt0413845","seriesID":"tt0486531","Type":"episode","Response":"True"},{"Title":"The Room","Year":"2003","Rated":"R","Released":"03 Mar 2004","Runtime":"99 min","Genre":"Drama","Director":"Tommy Wiseau","Writer":"Tommy Wiseau","Actors":"Tommy Wiseau, Juliette Danielle, Greg Sestero, Philip Haldiman","Plot":"Johnny is a successful bank executive who lives quietly in a San Francisco townhouse with his future wife Lisa. One day she unscrupulously seduces his best friend Mark. Nothing will ever be the same again.","Language":"English","Country":"USA","Awards":"1 win.","Poster":"https://m.media-amazon.com/images/M/MV5BYjEzN2FlYmYtNDkwMC00NGFkLWE5ODctYmE5NmYxNzE2MmRiXkEyXkFqcGdeQXVyMjMwODc5Mw@@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"3.7/10"},{"Source":"Rotten Tomatoes","Value":"25%"},{"Source":"Metacritic","Value":"9/100"}],"Metascore":"9","imdbRating":"3.7","imdbVotes":"79,787","imdbID":"tt0368226","Type":"movie","DVD":"17 Dec 2005","BoxOffice":"N/A","Production":"Chloe Productions","Website":"N/A","Response":"True"}]');

// test GET /searchMovieByDirector/:query
testAPI('searchMovieByDirector/Tommy%20Wiseau', '[{"Title":"The Room","Year":"2003","Rated":"R","Released":"03 Mar 2004","Runtime":"99 min","Genre":"Drama","Director":"Tommy Wiseau","Writer":"Tommy Wiseau","Actors":"Tommy Wiseau, Juliette Danielle, Greg Sestero, Philip Haldiman","Plot":"Johnny is a successful bank executive who lives quietly in a San Francisco townhouse with his future wife Lisa. One day she unscrupulously seduces his best friend Mark. Nothing will ever be the same again.","Language":"English","Country":"USA","Awards":"1 win.","Poster":"https://m.media-amazon.com/images/M/MV5BYjEzN2FlYmYtNDkwMC00NGFkLWE5ODctYmE5NmYxNzE2MmRiXkEyXkFqcGdeQXVyMjMwODc5Mw@@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"3.7/10"},{"Source":"Rotten Tomatoes","Value":"25%"},{"Source":"Metacritic","Value":"9/100"}],"Metascore":"9","imdbRating":"3.7","imdbVotes":"79,787","imdbID":"tt0368226","Type":"movie","DVD":"17 Dec 2005","BoxOffice":"N/A","Production":"Chloe Productions","Website":"N/A","Response":"True"},{"Title":"The Best Movie Ever","imdbID":"12345","Year":"1999","Rated":"R","Genre":"Action","Director":"Tommy Wiseau","Writer":"Tommy Wiseau","Actors":"John Cena, Tommy Wiseau","Plot":"John Cena and Tommy Wiseau do awesome stuff.","Released":"N/A","Runtime":"N/A","Language":"N/A","Country":"N/A","Awards":"N/A","Poster":"N/A","Ratings":"N/A","Metascore":"N/A","imdbRating":"N/A","imdbVotes":"N/A","Type":"N/A","DVD":"N/A","BoxOffice":"N/A","Production":"N/A","Website":"N/A","Response":"N/A"}]');

// test GET /searchMovieByActor/:query
testAPI('searchMovieByActor/John%20Cena', '[{"Title":"The Marine","Year":"2006","Rated":"PG-13","Released":"13 Oct 2006","Runtime":"92 min","Genre":"Action, Comedy, Drama, Thriller","Director":"John Bonito","Writer":"Michelle Gallagher (story), Michelle Gallagher (screenplay), Alan B. McElroy (screenplay)","Actors":"John Cena, Robert Patrick, Kelly Carlson, Anthony Ray Parker","Plot":"A group of diamond thieves on the run kidnap the wife of a recently discharged marine who goes on a chase through the South Carolinian wilderness to retrieve her.","Language":"English, Arabic","Country":"USA","Awards":"N/A","Poster":"https://m.media-amazon.com/images/M/MV5BMTE5OTU4NjQwMl5BMl5BanBnXkFtZTcwODI1ODYzMQ@@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"4.7/10"},{"Source":"Rotten Tomatoes","Value":"20%"},{"Source":"Metacritic","Value":"45/100"}],"Metascore":"45","imdbRating":"4.7","imdbVotes":"31,979","imdbID":"tt0419946","Type":"movie","DVD":"30 Jan 2007","BoxOffice":"$18,719,747","Production":"20th Century Fox","Website":"N/A","Response":"True"},{"Title":"The Best Movie Ever","imdbID":"12345","Year":"1999","Rated":"R","Genre":"Action","Director":"Tommy Wiseau","Writer":"Tommy Wiseau","Actors":"John Cena, Tommy Wiseau","Plot":"John Cena and Tommy Wiseau do awesome stuff.","Released":"N/A","Runtime":"N/A","Language":"N/A","Country":"N/A","Awards":"N/A","Poster":"N/A","Ratings":"N/A","Metascore":"N/A","imdbRating":"N/A","imdbVotes":"N/A","Type":"N/A","DVD":"N/A","BoxOffice":"N/A","Production":"N/A","Website":"N/A","Response":"N/A"}]');

// test GET /searchMovieByWriter/:query
testAPI('searchMovieByWriter/Tommy%20Wiseau', '[{"Title":"The Room","Year":"2003","Rated":"R","Released":"03 Mar 2004","Runtime":"99 min","Genre":"Drama","Director":"Tommy Wiseau","Writer":"Tommy Wiseau","Actors":"Tommy Wiseau, Juliette Danielle, Greg Sestero, Philip Haldiman","Plot":"Johnny is a successful bank executive who lives quietly in a San Francisco townhouse with his future wife Lisa. One day she unscrupulously seduces his best friend Mark. Nothing will ever be the same again.","Language":"English","Country":"USA","Awards":"1 win.","Poster":"https://m.media-amazon.com/images/M/MV5BYjEzN2FlYmYtNDkwMC00NGFkLWE5ODctYmE5NmYxNzE2MmRiXkEyXkFqcGdeQXVyMjMwODc5Mw@@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"3.7/10"},{"Source":"Rotten Tomatoes","Value":"25%"},{"Source":"Metacritic","Value":"9/100"}],"Metascore":"9","imdbRating":"3.7","imdbVotes":"79,787","imdbID":"tt0368226","Type":"movie","DVD":"17 Dec 2005","BoxOffice":"N/A","Production":"Chloe Productions","Website":"N/A","Response":"True"},{"Title":"The Best Movie Ever","imdbID":"12345","Year":"1999","Rated":"R","Genre":"Action","Director":"Tommy Wiseau","Writer":"Tommy Wiseau","Actors":"John Cena, Tommy Wiseau","Plot":"John Cena and Tommy Wiseau do awesome stuff.","Released":"N/A","Runtime":"N/A","Language":"N/A","Country":"N/A","Awards":"N/A","Poster":"N/A","Ratings":"N/A","Metascore":"N/A","imdbRating":"N/A","imdbVotes":"N/A","Type":"N/A","DVD":"N/A","BoxOffice":"N/A","Production":"N/A","Website":"N/A","Response":"N/A"}]');

// test GET /searchMovieByPerson/:query
testAPI('searchMovieByPerson/John%20Cena', '[{"Title":"The Marine","Year":"2006","Rated":"PG-13","Released":"13 Oct 2006","Runtime":"92 min","Genre":"Action, Comedy, Drama, Thriller","Director":"John Bonito","Writer":"Michelle Gallagher (story), Michelle Gallagher (screenplay), Alan B. McElroy (screenplay)","Actors":"John Cena, Robert Patrick, Kelly Carlson, Anthony Ray Parker","Plot":"A group of diamond thieves on the run kidnap the wife of a recently discharged marine who goes on a chase through the South Carolinian wilderness to retrieve her.","Language":"English, Arabic","Country":"USA","Awards":"N/A","Poster":"https://m.media-amazon.com/images/M/MV5BMTE5OTU4NjQwMl5BMl5BanBnXkFtZTcwODI1ODYzMQ@@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"4.7/10"},{"Source":"Rotten Tomatoes","Value":"20%"},{"Source":"Metacritic","Value":"45/100"}],"Metascore":"45","imdbRating":"4.7","imdbVotes":"31,979","imdbID":"tt0419946","Type":"movie","DVD":"30 Jan 2007","BoxOffice":"$18,719,747","Production":"20th Century Fox","Website":"N/A","Response":"True"},{"Title":"The Best Movie Ever","imdbID":"12345","Year":"1999","Rated":"R","Genre":"Action","Director":"Tommy Wiseau","Writer":"Tommy Wiseau","Actors":"John Cena, Tommy Wiseau","Plot":"John Cena and Tommy Wiseau do awesome stuff.","Released":"N/A","Runtime":"N/A","Language":"N/A","Country":"N/A","Awards":"N/A","Poster":"N/A","Ratings":"N/A","Metascore":"N/A","imdbRating":"N/A","imdbVotes":"N/A","Type":"N/A","DVD":"N/A","BoxOffice":"N/A","Production":"N/A","Website":"N/A","Response":"N/A"}]');

// test GET /getRecommended/:username
testAPI('getRecommended/Jersey', '[{"Title":"Harlem Nights","Year":"1989","Rated":"R","Released":"17 Nov 1989","Runtime":"116 min","Genre":"Comedy, Crime, Drama","Director":"Eddie Murphy","Writer":"Eddie Murphy","Actors":"Eddie Murphy, Richard Pryor, Redd Foxx, Danny Aiello","Plot":"During the 1930s, a New York City illegal gambling house owner and his associates must deal with strong competition, gangsters, and corrupt cops in order to stay in business.","Language":"English","Country":"USA","Awards":"Nominated for 1 Oscar. Another 2 wins & 1 nomination.","Poster":"https://m.media-amazon.com/images/M/MV5BODlmNjc1MjYtMjBhOC00ZGFjLTkwMWUtYWNhMDAyYmJlNWEwXkEyXkFqcGdeQXVyMTQxNzMzNDI@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"6.1/10"},{"Source":"Rotten Tomatoes","Value":"21%"},{"Source":"Metacritic","Value":"16/100"}],"Metascore":"16","imdbRating":"6.1","imdbVotes":"19,802","imdbID":"tt0097481","Type":"movie","DVD":"29 Jan 2002","BoxOffice":"N/A","Production":"Paramount Home Video","Website":"N/A","Response":"True"},{"Title":"Austin Powers: International Man of Mystery","Year":"1997","Rated":"PG-13","Released":"02 May 1997","Runtime":"89 min","Genre":"Adventure, Comedy","Director":"Jay Roach","Writer":"Mike Myers","Actors":"Mike Myers, Elizabeth Hurley, Michael York, Mimi Rogers","Plot":"A 1960s secret agent is brought out of cryofreeze to oppose his greatest enemy in the 1990s, where his social attitudes are glaringly out of place.","Language":"English","Country":"USA","Awards":"3 wins & 8 nominations.","Poster":"https://m.media-amazon.com/images/M/MV5BMTRhZTY0MDItY2I1Yi00MGE3LTk1ZDEtMjA0ZGZhNDQyNGU0XkEyXkFqcGdeQXVyNTIzOTk5ODM@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"7.0/10"},{"Source":"Rotten Tomatoes","Value":"71%"},{"Source":"Metacritic","Value":"51/100"}],"Metascore":"51","imdbRating":"7.0","imdbVotes":"217,218","imdbID":"tt0118655","Type":"movie","DVD":"20 Oct 1997","BoxOffice":"N/A","Production":"New Line Home Entertainment","Website":"N/A","Response":"True"},{"Title":"Austin Powers: The Spy Who Shagged Me","Year":"1999","Rated":"PG-13","Released":"11 Jun 1999","Runtime":"95 min","Genre":"Action, Adventure, Comedy, Crime","Director":"Jay Roach","Writer":"Mike Myers, Michael McCullers, Mike Myers (characters)","Actors":"Mike Myers, Heather Graham, Michael York, Robert Wagner","Plot":"Dr. Evil is back and has invented a new time machine that allows him to go back to the 1960s and steal Austin Powers\' mojo, inadvertently leaving him \\"shagless\\".","Language":"English, German","Country":"USA","Awards":"Nominated for 1 Oscar. Another 18 wins & 30 nominations.","Poster":"https://m.media-amazon.com/images/M/MV5BMmFkZGQxN2YtODNlYS00MzM5LTk3NjQtNTUxYmQ1YzkwMDhmXkEyXkFqcGdeQXVyMTQxNzMzNDI@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"6.6/10"},{"Source":"Rotten Tomatoes","Value":"52%"},{"Source":"Metacritic","Value":"59/100"}],"Metascore":"59","imdbRating":"6.6","imdbVotes":"213,048","imdbID":"tt0145660","Type":"movie","DVD":"16 Nov 1999","BoxOffice":"N/A","Production":"New Line Cinema","Website":"N/A","Response":"True"},{"Title":"Wayne\'s World","Year":"1992","Rated":"PG-13","Released":"14 Feb 1992","Runtime":"94 min","Genre":"Comedy, Music","Director":"Penelope Spheeris","Writer":"Mike Myers (based on characters created by), Mike Myers, Bonnie Turner, Terry Turner","Actors":"Mike Myers, Dana Carvey, Rob Lowe, Tia Carrere","Plot":"Two slacker friends try to promote their public-access cable show.","Language":"English, Cantonese","Country":"USA","Awards":"4 wins & 5 nominations.","Poster":"https://m.media-amazon.com/images/M/MV5BMDAyNDY3MjUtYmJjYS00Zjc5LTlhM2MtNzgzYjNlOWVkZjkzL2ltYWdlL2ltYWdlXkEyXkFqcGdeQXVyNjU0OTQ0OTY@._V1_SX300.jpg","Ratings":[{"Source":"Internet Movie Database","Value":"7.0/10"},{"Source":"Rotten Tomatoes","Value":"84%"},{"Source":"Metacritic","Value":"57/100"}],"Metascore":"57","imdbRating":"7.0","imdbVotes":"141,361","imdbID":"tt0105793","Type":"movie","DVD":"16 Nov 1999","BoxOffice":"N/A","Production":"Paramount Pictures","Website":"N/A","Response":"True"}]');

// test GET /people/:name
testAPI('people/John%20Cena', '{"Name":"John Cena","Directed":[],"Wrote":[],"Acted":["tt0419946","12345"]}');

// test GET /searchPerson/:query
testAPI('searchPerson/Tommy', '[{"Name":"Tommy \'Tiny\' Lister","Directed":[],"Wrote":[],"Acted":["tt0113118","tt0097987"]},{"Name":"Tommy Lee Jones","Directed":["tt0419294","tt1510938"],"Wrote":[],"Acted":["tt0112462","tt0109446","tt0109450","tt0109303","tt0109306","tt0106977","tt0120461","tt0119654","tt0120873","tt0150377","tt0077530","tt0160797","tt0186566","tt0092656","tt0098051","tt0080549","tt0120912","tt0269347","tt0338188","tt0096639","tt0419294","tt0420087","tt0478134","tt0477348","tt0910905","tt1172991","tt1510938","tt0458339","tt1409024","tt4196776"]},{"Name":"Tommy Chong","Directed":["tt0082163","tt0080520","tt0087042"],"Wrote":["tt0078446","tt0082163","tt0080520","tt0087042"],"Acted":["tt0113936","tt0078446","tt0084156","tt0082163","tt0080520","tt0087042","tt0088680"]},{"Name":"Tommy Kirk","Directed":[],"Wrote":[],"Acted":["tt0053271","tt0054594","tt0057518","tt0058440"]},{"Name":"Tommy Swerdlow","Directed":[],"Wrote":["tt0106611","tt0281373","tt0110364"],"Acted":[]},{"Name":"Lou Adler, Tommy Chong","Directed":["tt0078446"],"Wrote":[],"Acted":[]},{"Name":"Tommy Lee Wallace","Directed":["tt0085636","tt0097390"],"Wrote":["tt0083550","tt0085636","tt0097390"],"Acted":[]},{"Name":"Tommy Davidson","Directed":[],"Wrote":[],"Acted":["tt0118750","tt0120531","tt0215545","tt0247444","tt0102996"]},{"Name":"Tommy Sands","Directed":[],"Wrote":[],"Acted":["tt0054649"]},{"Name":"Tommy O\'Haver","Directed":["tt0137386","tt0192071","tt0327679","tt0802948"],"Wrote":["tt0137386","tt0802948"],"Acted":[]},{"Name":"Tommy Tweed","Directed":[],"Wrote":[],"Acted":["tt0057180"]},{"Name":"Tommy Cook","Directed":[],"Wrote":["tt0076636"],"Acted":[]},{"Name":"Tommy Bone","Directed":[],"Wrote":[],"Acted":["tt0125971"]},{"Name":"Tommy Redmond Hicks","Directed":[],"Wrote":[],"Acted":["tt0091939"]},{"Name":"Tommy Hinkley","Directed":[],"Wrote":[],"Acted":["tt0092608"]},{"Name":"Tommy Rettig","Directed":[],"Wrote":[],"Acted":["tt0045464"]},{"Name":"Tommy Dysart","Directed":[],"Wrote":[],"Acted":["tt0084296"]},{"Name":"Tommy Flanagan","Directed":[],"Wrote":[],"Acted":["tt0278295","tt0171685","tt0455857"]},{"Name":"Tommy Rall","Directed":[],"Wrote":[],"Acted":["tt0047472"]},{"Name":"Tommy the Clown","Directed":[],"Wrote":[],"Acted":["tt0436724"]},{"Name":"Tommy Wirkola","Directed":["tt1278340","tt1428538"],"Wrote":["tt1278340","tt1428538"],"Acted":[]},{"Name":"Tommy Reid","Directed":[],"Wrote":["tt2113683"],"Acted":[]},{"Name":"Tommy Wiseau","Directed":["tt0368226","12345"],"Wrote":["tt0368226","12345"],"Acted":["tt0368226","12345"]}]');

setTimeout(() => { console.log("%d test cases failed", num_failed); }, 2000);
